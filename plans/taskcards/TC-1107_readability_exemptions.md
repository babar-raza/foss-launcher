---
id: TC-1107
title: "W5.5 ContentReviewer: Readability Exemptions for Navigation/FAQ Pages"
status: Draft
owner: Agent C
track: Track 3 ContentReviewer Final Tuning
created: "2026-02-10"
updated: "2026-02-10"
depends_on: []
spec_ref: 60acd31b02cb92674179b7582af6810a1eb33ac1
ruleset_version: ruleset.v1
templates_version: templates.v1
allowed_paths:
  - src/launch/workers/w5_5_content_reviewer/checks/content_quality.py
  - tests/unit/workers/w5_5_content_reviewer/test_checks.py
  - plans/taskcards/TC-1107_readability_exemptions.md
  - plans/taskcards/INDEX.md
  - reports/agents/agent_c/TC-1107_readability_exemptions/**
evidence_required:
  - Implementation changes to content_quality.py
  - Test results showing 4+ new tests passing
  - Evidence that index.md and faq.md readability errors are eliminated
  - 12D self-review with scores >=4/5 all dimensions
---

# TC-1107: W5.5 ContentReviewer: Readability Exemptions for Navigation/FAQ Pages

## Objective

Fix false positive readability errors for navigation and FAQ pages by implementing page-type-specific thresholds in W5.5 ContentReviewer's readability check. Navigation pages (index, toc, landing) should skip readability checks entirely, while Q&A format pages (faq, troubleshooting) should have relaxed thresholds (18 instead of 16).

**Problem**: Current implementation flags index.md (grade 20.0) and faq.md (grade 16.3) as readability errors. These are false positives because:
- Navigation pages are link hubs, not prose-heavy content
- FAQ pages follow Q&A format with naturally higher complexity
- These page types serve different purposes than content pages

**Solution**: Detect page role from page_plan and apply role-specific exemptions.

## Required spec references

- `specs/27_abstract-hugging-kite.md:347` (Check 2: Readability Score)
  - Target grade 8-12, WARN if >14, ERROR if >16
- `specs/18_page_plan_anatomy.md` (Page Plan Schema)
  - `page_role` field definition
- `specs/schemas/page_plan.schema.json` (Page Plan JSON Schema)
  - `page_role` enum values

## Scope

### In scope

1. Update `_check_2_readability_score()` in `content_quality.py` to:
   - Extract `page_role` from `page_plan` parameter
   - Skip check entirely for navigation pages: `index`, `toc`, `landing`
   - Relax threshold to 18 (from 16) for Q&A pages: `faq`, `troubleshooting`
   - Keep original threshold 16 for all other pages
2. Add 4+ tests in `test_checks.py`:
   - Test 1: index page with grade 20 returns no error (skipped)
   - Test 2: faq page with grade 17 returns warn (relaxed threshold)
   - Test 3: faq page with grade 19 returns error (still enforced)
   - Test 4: content page with grade 17 returns error (original logic)
3. Verify 2 existing errors eliminated (index.md, faq.md)

### Out of scope

- Changes to other check functions
- Changes to page_plan generation logic (W4 responsibility)
- New page_role enum values (spec-level decision)
- Changes to other severity thresholds

## Preconditions / dependencies

- `page_plan` parameter already passed to `check_all()` in `content_quality.py`
- `page_role` field present in page_plan.json (generated by W4)
- Existing test infrastructure for content_quality checks

## Inputs

1. **page_plan.json structure**:
   ```json
   {
     "pages": [
       {
         "slug": "index",
         "page_role": "toc",
         "output_path": "content/docs.aspose.org/3d/en/python/docs/_index.md",
         ...
       }
     ]
   }
   ```
2. **Readability grade calculation**: Flesch-Kincaid grade level (existing helper)
3. **Current thresholds**:
   - WARN: grade > 14
   - ERROR: grade > 16

## Outputs

1. **Modified `content_quality.py`**:
   - Page role extraction logic
   - Conditional exemption/relaxation logic
2. **New tests in `test_checks.py`**:
   - 4+ tests covering all exemption scenarios
3. **Evidence package**:
   - `reports/agents/agent_c/TC-1107_readability_exemptions/plan.md`
   - `reports/agents/agent_c/TC-1107_readability_exemptions/changes.md`
   - `reports/agents/agent_c/TC-1107_readability_exemptions/evidence.md`
   - `reports/agents/agent_c/TC-1107_readability_exemptions/self_review.md`

## Allowed paths

- src/launch/workers/w5_5_content_reviewer/checks/content_quality.py
- tests/unit/workers/w5_5_content_reviewer/test_checks.py
- plans/taskcards/TC-1107_readability_exemptions.md
- plans/taskcards/INDEX.md
- reports/agents/agent_c/TC-1107_readability_exemptions/**

## Implementation steps

### Step 1: Understand page_role field structure

1. Review `page_plan.json` samples from recent pilot runs
2. Confirm `page_role` values: `index`, `toc`, `landing`, `faq`, `troubleshooting`, `comprehensive_guide`, etc.
3. Verify page slug normalization (_index → index in some contexts)

### Step 2: Implement page role extraction

1. Locate `_check_2_readability_score()` function (around line 137-169)
2. Add logic to extract `page_role` from `page_plan` parameter:
   ```python
   # Get page role from page_plan
   page_role = None
   pages = page_plan.get('pages', [])
   for page in pages:
       # Match by slug or filename
       if page.get('slug') == page_slug or page.get('filename') == f"{page_slug}.md":
           page_role = page.get('page_role', '')
           break
   ```
3. Handle edge cases:
   - `page_plan` is None or empty
   - `page_slug` not found in pages list
   - `page_role` field missing

### Step 3: Implement exemption logic

1. Add navigation page exemption (skip check entirely):
   ```python
   # Exempt navigation pages from readability check
   if page_role in ['index', 'toc', 'landing']:
       return []  # Skip check entirely
   ```
2. Add Q&A page relaxation:
   ```python
   # Relax threshold for FAQ/troubleshooting pages
   if page_role in ['faq', 'troubleshooting']:
       if grade > 18:  # Relaxed from 16
           severity = "error"
       elif grade > 14:
           severity = "warn"
   else:
       # Original logic for content pages
       if grade > 16:
           severity = "error"
       elif grade > 14:
           severity = "warn"
   ```

### Step 4: Update function signature

1. Verify `_check_2_readability_score()` receives `page_plan` parameter
2. Current signature: `_check_2_readability_score(content: str, rel_path: str, page_slug: str)`
3. Update to: `_check_2_readability_score(content: str, rel_path: str, page_slug: str, page_plan: Dict[str, Any])`
4. Update call site in `check_all()` function (around line 81)

### Step 5: Write tests

1. Add test fixtures for page_plan with different page_roles
2. Test 1: Navigation page exemption
   ```python
   def test_readability_index_page_exempted():
       """Index pages skip readability check entirely."""
       content = "..." # High complexity text (grade 20+)
       page_plan = {"pages": [{"slug": "index", "page_role": "toc"}]}
       issues = _check_2_readability_score(content, "test.md", "index", page_plan)
       assert len(issues) == 0  # No issues
   ```
3. Test 2: FAQ page relaxed threshold (warn)
   ```python
   def test_readability_faq_relaxed_warn():
       """FAQ pages warn at grade 17 (relaxed from 16)."""
       content = "..." # Grade 17 text
       page_plan = {"pages": [{"slug": "faq", "page_role": "faq"}]}
       issues = _check_2_readability_score(content, "test.md", "faq", page_plan)
       assert len(issues) == 1
       assert issues[0]["severity"] == "warn"
   ```
4. Test 3: FAQ page error at grade 19
5. Test 4: Content page original threshold (error at grade 17)

### Step 6: Run tests

1. Run all content_quality tests: `pytest tests/unit/workers/w5_5_content_reviewer/test_checks.py -v`
2. Verify 4+ new tests pass
3. Verify no regressions in existing tests

### Step 7: Verify pilot runs

1. Run 3D pilot: `PYTHONHASHSEED=0 .venv/Scripts/python.exe scripts/run_pilot.py --pilot pilot-aspose-3d-foss-python --output runs/tc1107_3d_verify`
2. Check review_report.json for eliminated errors:
   - Before: 2 readability errors (index.md grade 20, faq.md grade 16.3)
   - After: 0 readability errors for these pages
3. Verify other pages still checked with original threshold

### Step 8: Create evidence package

1. Create directory: `reports/agents/agent_c/TC-1107_readability_exemptions/`
2. Write `plan.md`: Implementation approach and rationale
3. Write `changes.md`: Code changes with before/after diffs
4. Write `evidence.md`: Test results and pilot run verification
5. Write `self_review.md`: 12D self-review (use template)

## Failure modes

### Failure Mode 1: page_role field missing in page_plan

**Detection**: Tests fail with KeyError or AttributeError when accessing page_role

**Resolution**:
1. Add defensive check: `page_role = page.get('page_role', '')` (default to empty string)
2. If page_role is empty, fall back to original threshold logic
3. Verify W4 generates page_role field in all pilots

**Spec/Gate**: `specs/18_page_plan_anatomy.md` (page_role field required)

### Failure Mode 2: Slug matching fails due to normalization

**Detection**: Exemptions not applied even though page_role is correct

**Resolution**:
1. Check for both slug and filename: `page.get('slug') == page_slug or page.get('filename') == f"{page_slug}.md"`
2. Handle _index → index normalization
3. Add debug logging to track slug matching

**Spec/Gate**: `specs/18_page_plan_anatomy.md` (slug normalization rules)

### Failure Mode 3: Tests pass but pilot runs still show errors

**Detection**: Pilot runs show readability errors for index/faq pages after implementation

**Resolution**:
1. Verify page_plan parameter passed correctly to `_check_2_readability_score()`
2. Check call site in `check_all()` function
3. Add debug print to verify page_role extracted correctly
4. Re-run pilot with verbose logging

**Spec/Gate**: Gate 14 (content quality checks)

## Task-specific review checklist

1. Page role extraction handles all edge cases (None, empty, missing)
2. Navigation pages (index, toc, landing) skip check entirely (return empty list)
3. FAQ pages (faq, troubleshooting) use relaxed threshold 18 (not 16)
4. Content pages retain original threshold 16
5. Function signature updated to accept page_plan parameter
6. Call site in check_all() updated to pass page_plan
7. 4+ tests added covering all scenarios
8. All tests pass (new + existing)
9. No regressions in existing functionality
10. Pilot runs eliminate 2 false positive errors
11. Evidence package complete (plan, changes, evidence, self_review)
12. 12D self-review scores >=4/5 all dimensions

## Test plan

### Unit tests (4+ new tests)

1. `test_readability_index_page_exempted()`: Navigation page skipped
2. `test_readability_toc_page_exempted()`: TOC page skipped
3. `test_readability_faq_relaxed_warn()`: FAQ page warns at grade 17
4. `test_readability_faq_error_at_19()`: FAQ page errors at grade 19
5. `test_readability_content_page_original()`: Content page errors at grade 17
6. `test_readability_missing_page_plan()`: Fallback to original logic if page_plan missing

### Integration tests (pilot runs)

1. Run 3D pilot and verify review_report.json shows 0 readability errors for index.md
2. Run Note pilot and verify review_report.json shows 0 readability errors for faq.md
3. Verify other pages (getting-started, overview) still checked with original threshold

## E2E verification

**Concrete command**:
```bash
# Run 3D pilot
PYTHONHASHSEED=0 .venv/Scripts/python.exe scripts/run_pilot.py \
  --pilot pilot-aspose-3d-foss-python \
  --output runs/tc1107_3d_verify

# Check review report for readability issues
python -c "
import json
rr = json.load(open('runs/tc1107_3d_verify/artifacts/review_report.json'))
readability_issues = [i for i in rr['issues'] if 'readability' in i['check']]
print(f'Readability issues: {len(readability_issues)}')
for issue in readability_issues:
    print(f\"  - {issue['location']['path']}: {issue['severity']} - {issue['message']}\")
"
```

**Expected artifacts**:
1. `runs/tc1107_3d_verify/artifacts/review_report.json` exists
2. Zero readability errors for `index.md` (previously grade 20.0 ERROR)
3. Zero or WARN-only readability issues for `faq.md` (previously grade 16.3 ERROR)
4. Content pages (e.g., `getting-started.md`) still checked with original threshold (ERROR at grade >16)
5. Exit code 0 (pilot completes successfully)

## Integration boundaries

**Upstream integration (W4 IAPlanner)**:
- **Input contract**: `page_plan.json` with `page_role` field for each page
- **Required fields**: `pages[].slug`, `pages[].page_role`, `pages[].filename`
- **Page role enum**: `index`, `toc`, `landing`, `faq`, `troubleshooting`, `comprehensive_guide`, etc.
- **Failure handling**: If page_role missing, fall back to original threshold (no exemption)

**Downstream integration (W5.5 Scoring)**:
- **Output contract**: List of issue dicts (unchanged format)
- **Impact**: Reduced issue count for navigation/FAQ pages
- **Routing impact**: Better scores (fewer errors) may change PASS/NEEDS_CHANGES/REJECT routing
- **Guarantee**: No new false negatives (content pages still checked with original threshold)

**Test integration**:
- **Test fixtures**: Add `page_plan` parameter to existing test helper functions
- **Mocking strategy**: Mock page_plan structure inline (no external dependencies)
- **Isolation**: Tests do not depend on W4 or actual page_plan.json files

## Integration boundary proven

**Upstream boundary (W4 → W5.5)**:
- **Proof**: Existing pilot runs show page_plan.json contains page_role field
- **Command**: `python -c "import json; pp = json.load(open('runs/r_20260205T140239Z_launch_pilot-aspose-3d-foss-python_3711472_default_742e0dce/artifacts/page_plan.json')); print([p.get('page_role') for p in pp.get('pages', [])[:3]])"`
- **Expected output**: `['landing', 'toc', 'comprehensive_guide']` (page_role values present)

**Downstream boundary (W5.5 → W5.5 Scoring)**:
- **Proof**: Scoring module already handles variable issue counts
- **Test**: Existing tests show scoring handles 0 issues, 1 issue, many issues
- **Evidence**: `test_no_issues_returns_all_fives()` in `tests/unit/workers/w5_5_content_reviewer/test_checks.py:22`

**Cross-worker impact**:
- **None**: This change is internal to W5.5 content_quality check
- **No W4 changes**: W4 already generates page_role field
- **No W7 changes**: W7 validates final output, not intermediate check results

### End-to-end verification

**Scenario**: 3D pilot run with index.md (grade 20) and faq.md (grade 17)

**Expected outcome**:
- index.md: No readability error (exempted)
- faq.md: Warn severity (relaxed threshold)
- getting-started.md (grade 17): Error severity (original threshold)

**Verification commands**:
```bash
# Run 3D pilot
PYTHONHASHSEED=0 .venv/Scripts/python.exe scripts/run_pilot.py \
  --pilot pilot-aspose-3d-foss-python \
  --output runs/tc1107_3d_verify

# Check review report
python -c "import json; rr = json.load(open('runs/tc1107_3d_verify/artifacts/review_report.json')); print(json.dumps([i for i in rr['issues'] if 'readability' in i['check']], indent=2))"

# Verify error count reduced
# Before: 2 errors (index.md, faq.md)
# After: 0-1 errors (only non-exempt pages)
```

### Integration boundaries

**Upstream (W4 IAPlanner)**:
- **Input**: page_plan.json with page_role field
- **Contract**: page_role enum values defined in specs/18_page_plan_anatomy.md
- **Failure mode**: Missing page_role field → fallback to original threshold

**Downstream (W5.5 scoring)**:
- **Output**: Reduced issue count for navigation/FAQ pages
- **Contract**: Issues dict format unchanged (issue_id, check, severity, message, location)
- **Failure mode**: Incorrectly exempted pages → lower quality scores than expected

**Test integration**:
- **Dependency**: test_checks.py existing fixtures
- **Extension**: Add page_plan parameter to test fixtures
- **Isolation**: Tests mock page_plan structure, no W4 dependency

## Deliverables

1. **Code changes**:
   - Modified `src/launch/workers/w5_5_content_reviewer/checks/content_quality.py`
   - Modified `tests/unit/workers/w5_5_content_reviewer/test_checks.py`

2. **Test results**:
   - All existing tests pass
   - 4+ new tests pass
   - Pytest output showing test names and results

3. **Pilot verification**:
   - 3D pilot run artifacts
   - review_report.json showing eliminated errors
   - Before/after comparison

4. **Evidence package** (`reports/agents/agent_c/TC-1107_readability_exemptions/`):
   - `plan.md`: Implementation approach
   - `changes.md`: Code diffs and rationale
   - `evidence.md`: Test results and pilot verification
   - `self_review.md`: 12D self-review with scores

5. **Git commit**:
   - Message: "feat(w5.5): add readability exemptions for navigation/FAQ pages"
   - Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>

## Acceptance checks

1. Taskcard created with all required sections
2. Taskcard registered in `plans/taskcards/INDEX.md`
3. Taskcard validated with `tools/validate_taskcards.py` (0 errors)
4. Implementation complete in `content_quality.py`
5. Function signature updated to accept `page_plan` parameter
6. Call site in `check_all()` updated to pass `page_plan`
7. 4+ tests added in `test_checks.py`
8. All tests pass (new + existing)
9. 3D pilot run shows 0 readability errors for index.md
10. Note pilot run shows 0 readability errors for faq.md
11. Evidence package complete (4 files)
12. 12D self-review shows >=4/5 all dimensions
13. Git commit created with Co-Authored-By

## Self-review

To be completed after implementation using `reports/templates/self_review_12d.md`.
